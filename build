#!/usr/bin/env nodejs
var fs     = require('fs');
var output = fs.readFileSync('/home/alex/code/networking/stirfry/src/index.js').toString();

var regexp = /#include\b.*?;/g;
while (true) {
	var matches = output.match(regexp);
	if (matches == null) {
		break;
	}
	else for (var i in matches) {
		var fileName = matches[i].slice(9, -1);
		output = output.replace(matches[i], fs.readFileSync('/home/alex/code/networking/stirfry/src/' + fileName).toString());
	}
}
output = "//This code has been precompiled, please do not edit it. If you would like to make your own changes visit github\n" + output;

try {
	eval(output);
	fs.writeFile('/home/alex/code/networking/stirfry/stirfry.js', output);
} catch (err) {
	console.log(err);
}
